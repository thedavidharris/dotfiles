# Find and edit files quickly with fzf
# Usage: fe [directory]
# Example: fe (searches current directory)

# Default to current directory if no argument provided
search_dir="${1:-.}"

if ! command -v fzf >/dev/null 2>&1; then
  echo "fzf not installed. Install with: brew install fzf" >&2
  return 1
fi

if ! command -v bat >/dev/null 2>&1; then
  echo "bat not installed. Install with: brew install bat" >&2
  echo "Continuing without preview..." >&2
fi

local file
if command -v bat >/dev/null 2>&1; then
  file=$(find "$search_dir" -type f -not -path '*/\.git/*' | fzf --preview 'bat --color=always {}' 2>/dev/null)
else
  file=$(find "$search_dir" -type f -not -path '*/\.git/*' | fzf 2>/dev/null)
fi

if [[ -n "$file" ]]; then
  ${EDITOR:-nvim} "$file"
else
  echo "No file selected" >&2
  return 1
fi
