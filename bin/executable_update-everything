#!/bin/bash

set -euo pipefail

echo "ğŸ”„ Updating system packages and plugins..."
echo "ğŸ“ Note: Plugin updates are local only, config changes sync with dotfiles"
echo ""

# Update LazyVim and all plugins (LOCAL ONLY - doesn't affect dotfiles)
echo "ğŸ§© Updating Neovim plugins (local only)..."
nvim --headless "+Lazy! sync" +qa
echo "âœ… LazyVim and plugins updated!"
echo ""

# Update system tools
if command -v brew &> /dev/null; then
    echo "ğŸº Updating Homebrew packages..."
    brew update && brew upgrade
    echo ""
fi

if command -v mise &> /dev/null; then
    echo "ğŸ”§ Updating mise tools..."
    mise upgrade
    echo ""
fi

# Check for chezmoi dotfiles updates
echo "ğŸ“‚ Checking dotfiles for updates..."
if command -v chezmoi &> /dev/null; then
    echo "ğŸ”„ Pulling latest dotfiles..."
    chezmoi update
    echo "âœ… Dotfiles updated!"
else
    echo "âš ï¸  Chezmoi not found, skipping dotfiles update"
fi

echo ""
echo "ğŸ‰ All updates complete!"
echo ""
echo "ğŸ“‹ Summary:"
echo "  â€¢ Neovim plugins: Updated locally (not synced to dotfiles)"
echo "  â€¢ System packages: Updated"
echo "  â€¢ Dotfiles: Synced with remote repository"
echo ""
echo "ğŸ’¡ If you made config changes, run 'chezmoi add' and commit them"
